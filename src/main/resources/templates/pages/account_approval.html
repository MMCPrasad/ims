<!DOCTYPE html>
<!--
Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/JSP_Servlet/Html.html to edit this template
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" dir="ltr">

    <head>
        <div th:replace="~{./ui/header.html}"></div>
    </head>

    <body>
        <main class="main" id="top">
            <div class="container-fluid" data-layout="container">
                <div th:replace="~{./ui/sidebar.html}"></div>
                <div class="content">
                    <div th:replace="~{./ui/navbar.html}"></div>

                    <div class="container">
                        <div class="row" id="approval"></div>
                    </div>



                    <div id="acc_Temp" style="display: none">

                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="px-4 py-2">

                                        <div class="card-body">
                                            <form>

                                                <div class="row">
                                                    <div class="col-md-4">
                                                        <label for="product">Product</label>
                                                        <select id="product" class="form-select ajax-select" ajax="common/product/select"
                                                                refid="id" reftxt="text" disabled required=""></select>
                                                    </div>

                                                    <div class="col-md-4">
                                                        <label for="category"> Category </label>
                                                        <input class="form-control"  id="category" disabled placeholder="">
                                                    </div>

                                                    <div class="col-md-4">
                                                        <label for="branch">Branch </label>
                                                        <select id="branch" class="form-select ajax-select" ajax="common/branch/select"
                                                                refid="id" reftxt="text" disabled required=""></select>
                                                    </div>
                                                </div>



                                                <div class="row">
                                                    <div class="col-md-4">
                                                        <label for="customerId">Customer Id</label>
                                                        <select id="customerId" class="form-select ajax-select" ajax="common/customer/select"
                                                                refid="id" reftxt="id" disabled required=""></select>
                                                    </div>

                                                    <div class="col-md-4">
                                                        <label for="currency"> Currency <span class="text-danger">*</span></label>
                                                        <input class="form-control"  id="currency"disabled placeholder="">
                                                    </div>

                                                    <div class="col-md-4">
                                                        <label class="form-label" for="postingRestriction"> Posting Restriction</label>
                                                        <select class="form-select ajax-select" id="postingRestriction" disabled required="">
                                                            <option value="Credit">Credit</option>
                                                            <option value="Debit">Debit</option>
                                                            <  <option value="All">All</option>

                                                        </select>
                                                    </div>


                                                </div>

                                                <div class="row">


                                                    <div class="col-md-12 mb-3">
                                                        <div class="row">
                                                            <div class="col-md-3 "> <label class="form-label" for="mobiles">Joint Customer</label></div>
                                                            <div class="col-md-3 "> <label class="form-label" for="mobiles">Relation Type</label></div>
                                                            <div class="col-lg-12 dataArray" id="jointCustomer" disabled func="addjointcustomer"></div>
                                                        </div>


                                                    </div>
                                                </div>

                                                <div class="row">

                                                    <div class="col-md-4">
                                                        <label for="accountNo"> Account No</label>
                                                        <input class="form-control"  id="accountNo"disabled placeholder="">
                                                    </div>

                                                    <div class="col-md-4">
                                                        <label for="accountName"> Account Name</label>
                                                        <input class="form-control"  id="accountName" disabled placeholder="">
                                                    </div>

                                                    <div class="col-md-4">
                                                        <label for="accountOfficer"> Account Officer</label>
                                                        <select id="accountOfficer" class="form-select ajax-select" ajax="common/account-officer/select"
                                                                refid="id" reftxt="text"  disabled required=""></select>
                                                    </div>

                                                </div>

                                                <div class="row">
                                                    <div class="col-md-4">
                                                        <label for="shortTile"> Short Tile </label>
                                                        <input class="form-control"  id="shortTile" disabled placeholder="">
                                                    </div>

                                                    <div class="col-md-4">
                                                        <label for="interestBasis"> Interest Basis<span class="text-danger">*</span> </label>
                                                        <input class="form-control"  id="interestBasis"disabled placeholder="">
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label for="taxCode">   Tax Code </label>
                                                        <input class="form-control"  id="taxCode"disabled placeholder="">
                                                    </div>

                                                </div>

                                                <div class="row">

                                                    <div class="col-md-4">
                                                        <label class="form-label" for="allowdhequedeposit"> Allow Cheque Deposit</label>
                                                        <select class="form-select ajax-select" id="allowdhequedeposit"  disabled required="">
                                                            <option value="yes">Yes</option>
                                                            <option value="no">No</option>

                                                        </select>
                                                    </div>

                                                    <div class="col-md-4">
                                                        <label for="curdate"> Opening Date<span class="text-danger">*</span></label>
                                                        <input  class="form-control"  id="curdate" disabled placeholder="">
                                                    </div>

                                                    <div class="col-md-4">
                                                        <label for="statementType"> Statement Type</label>
                                                        <select id="statementType" class="form-select ajax-select" ajax="common/statement-type/select"
                                                                refid="id" reftxt="text" disabled required=""></select>
                                                    </div>

                                                </div>

                                                <div class="row">

                                                    <div class="col-md-4">
                                                        <label class="form-label" for="accountstatus"> Account Status<span class="text-danger">*</span></label>
                                                        <select class="form-select  ajax-select" id="accountstatus" disabled required="">
                                                            <option value="active" selected="">Active</option>
                                                            <option value="dormant">Dormant </option>
                                                            <option value="inactive">Inactive </option>
                                                        </select>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label for="signature"> Signature </label>
                                                        <input type="file"  class="form-control"  id="signature" disabled >
                                                    </div>

                                                    <div class="col-md-4">
                                                        <label class="form-label" for="InterestRate">Interest Rate (%)</label>
                                                        <input type="number" class="form-control" id="InterestRate"disabled placeholder=""   min="0" max="100"
                                                               oninput="if(value < 0 || value > 100) value = '';">
                                                    </div>
                                                </div>
                                                <div class="row mt-3">
                                                    <hr class="w-100">
                                                </div>
                                                <div id="dynamicFieldsContainer" class="mt-3">
                                                    <div class="row">
                                                        <div class="col-md-12 mb-3">
                                                            <label class="form-label" for="mobiles">Documents</label>
                                                            <div class="col-lg-12 dataArray" id="documents" disabled func="addDocument"></div>

                                                        </div>

                                                    </div>
                                                </div>



                                                <div class="row mt-3">
                                                    <hr class="w-100">
                                                </div>
                                                <div class="col-md-12 mb-3">
                                                    <div class="row">
                                                        <div class="col-md-3 "> <label class="form-label" for="mobiles">Benifisary </label></div>
                                                        <div class="col-md-3 "> <label class="form-label" for="mobiles">Precentage </label></div>
                                                        <div class="col-md-3 "> <label class="form-label" for="mobiles">Account Number </label></div>
                                                        <div class="col-md-3 "> <label class="form-label" for="mobiles"> Benifisary Bank</label></div>
                                                        <div class="col-lg-12 dataArray" id="accountBenifisary" disabled func="addbenifisary"></div>
                                                    </div>


                                                </div>


                                                <div class="row mt-3">
                                                    <hr class="w-100">
                                                </div>

                                                <!--                          .........................................................................................................-->

                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <label for="accountbalance">  Account Balance</label>
                                                        <input class="form-control"  id="accountbalance"disabled  placeholder="">
                                                    </div>

                                                    <div class="col-md-3">
                                                        <label for="floatbalance">     Float Balance</label>
                                                        <input class="form-control"   id="floatbalance"disabled placeholder="">
                                                    </div>

                                                    <div class="col-md-3">
                                                        <label class="form-label" for="accruedInterest">Accrued Interest</label>
                                                        <input type="number" class="form-control" id="accruedInterest" disabled placeholder="" min="0" oninput="if(value < 0) value = '';">
                                                    </div>

                                                    <div class="col-md-3">
                                                        <label class="form-label" for="drAmount">DR Amount</label>
                                                        <input type="number" class="form-control" id="drAmount" disabled placeholder="" min="0" oninput="if(value < 0) value = '';">
                                                    </div>
                                                </div>

                                                <!--                       ....................................................................-->
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <label class="form-label" for="crAmount">CR Amount</label>
                                                        <input type="number" class="form-control" id="crAmount"disabled  placeholder="" min="0" oninput="if(value < 0) value = '';">
                                                    </div>






                                                </div>
                                                <div class="row mt-3">
                                                    <hr class="w-100">
                                                </div>

                                                <div class="col-md-3">
                                                    <label class="form-label" for="comment">Comment</label>
                                                    <textarea class="form-control" id="comment" name="comment" rows="4" cols="50"></textarea>
                                                </div>

                                                <div class="row pt-3">
                                                    <div class="col-md-1">
                                                        <label for="modBy">Mod By:</label>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <input type="text" id="modBy" class="form-control"
                                                            style="border: none; outline: none; background-color: transparent;">
                                                    </div>
                                                </div>
    
    
                                                <div class="row pt-3">
                                                    <div class="col-md-1">
                                                        <label for="modOn">Mod On:</label>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <input type="text" id="modOn" class="form-control "
                                                            style="border: none; outline: none; background-color: transparent;">
                                                    </div>
                                                </div>


                                            </form>

                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div th:replace="~{./ui/footer.html}">Side</div>
            </div>
        </main>

        <div th:replace="~{./ui/scripts.html}"></div>
        <script th:src="@{/vendors/select2/select2.min.js}"></script>


        <!-- <script src="js/fd-approvals.js"></script> -->

        <script th:src="@{/js/acc-approval.js?v=1}"></script>





        <script>
            $.fn.dataTable.ext.errMode = 'none';
            $(document).find('.ajax-select').each(function () {
                convertToSelect2(this);
            });

            let tableData = {
                columns: [
                    {"name": "ID", "data": "id", "visible": false},
                    {"name": "Account No", "data": "accountNo"},
                    {"name": "Customer", "data": "customerId"},
                    {"name": "Product", "data": "product"},

                    {"name": "Approval Status", "data": "approvalStatus", "width": "50px"}
                ],
                url: window.location.origin + contextPath + 'account/datatable',
                tableSize: 'col-12'
            };
            let formData = {
                url: window.location.origin + contextPath + 'account',
                customFields: $('#acc_Temp').children(),
                formSize: 'col-12',
                contentType: 'json'
            };


            new approvalInitiate($('#approval'), 'Account Approval', tableData, formData);



            function addjointcustomer(arryObj) {

                let temp = document.createElement('div');
                $(temp).addClass('input-group mb-2 dataArrayObject');
                $(temp).html('<select class="ajax-select dataArrayObjectElement" refid="id" reftxt="text" ajax="common/customer/select" placeholder="Joint customer"  name="customer" required=""></select>'
                        + '<select class="ajax-select dataArrayObjectElement" refid="id" reftxt="text" ajax="common/relation-type/select" placeholder="Relation Type"  name="relationType" required=""></select>'

                        + '<input type="hidden" class="form-control dataArrayObjectElement" placeholder="Id" name="id">'
                        );
                convertToSelect2($(temp).find('select')[0]);
                convertToSelect2($(temp).find('select')[1]);
                $(temp).find('.select2').attr('style', 'width: 25% !important;');
                if (arryObj) {
                    console.log(arryObj);
                    Object.keys(arryObj).forEach(function (key) {
                        setFieldData($(temp).find('[name="' + key + '"]'), arryObj[key]);
                    });
                }
                $('#jointCustomer').append(temp);
            }


            function addbenifisary(arryObj) {
                let temp = document.createElement('div');
                $(temp).addClass('input-group mb-2 dataArrayObject');
                $(temp).html('<select name="benifisary" class="form-select ajax-select dataArrayObjectElement" ajax="common/customer/select" refid="id" reftxt="text" placeholder="Benifisary" ></select>'
                        + ' <input type="number" class="form-control dataArrayObjectElement" name="percentage" placeholder="Percentage">'
                        + ' <input type="number" class="form-control dataArrayObjectElement " name="benAcc" placeholder="Account Number">'
                        + ' <select name="benBank" class="form-select ajax-select dataArrayObjectElement" ajax="common/bank/select" refid="id" reftxt="text" placeholder="Benifisary Bank" ></select>'
                        );
                convertToSelect2($(temp).find('select')[0]);
                convertToSelect2($(temp).find('select')[1]);
                $(temp).find('.select2').attr('style', 'width:25% !important')
                if (arryObj) {
                    Object.keys(arryObj).forEach(function (key) {
                        setFieldData($(temp).find('[name="' + key + '"]'), arryObj[key]);
                    });
                }
                $('#accountBenifisary').append(temp);
            }



            function addSignatureImage(arryObj) {
                let temp = document.createElement('div');
                $(temp).addClass('input-group mb-2 dataArrayObject');
                $(temp).html(
                        +'<input type="file" class="form-control dataArrayObjectElement" placeholder="Document" name="document" required="">'
                        + '<input type="text" class="form-control dataArrayObjectElement" placeholder="Comment" name="comment" required="">'
                        );
                convertToSelect2($(temp).find('select')[0]);
                $(temp).find('.select2').attr('style', 'width: 25% !important;');
                if (arryObj) {
                    $(temp).find('[name="document"]').attr('type', 'text');
                    Object.keys(arryObj).forEach(function (key) {
                        setFieldData($(temp).find('[name="' + key + '"]'), arryObj[key]);
                    });
                }
                $('#image').append(temp);
            }


            function addDocument(arryObj) {
                let temp = document.createElement('div');
                $(temp).addClass('input-group mb-2 dataArrayObject');
                $(temp).html('<select class="ajax-select dataArrayObjectElement" ajax="common/customer-document-type/select" placeholder="Document Type" refid="id" reftxt="text" name="docType" required=""></select>'
                        + '<input type="file" class="form-control dataArrayObjectElement" placeholder="Document" name="document" required="">'
                        + '<input type="text" class="form-control dataArrayObjectElement" placeholder="Comment" name="comment" required="">'
                        );
                convertToSelect2($(temp).find('select')[0]);
                $(temp).find('.select2').attr('style', 'width: 25% !important;');
                if (arryObj) {
                    $(temp).find('[name="document"]').attr('type', 'text');
                    Object.keys(arryObj).forEach(function (key) {
                        setFieldData($(temp).find('[name="' + key + '"]'), arryObj[key]);
                    });
                    let link = $(temp).find('[name="document"]').val();
                    $(temp).find('[name="document"]').replaceWith('<a  target="_blank" href="account-documents/' + link + '">Click to View</a>');
                }
                $('#documents').append(temp);
            }
        </script>
    </body>

</html>